<!doctype html>
<html lang="en">
  <head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
  <meta name="generator" content="Hugo 0.30.2" />                                                                   
               
    
  <title>ESPM 157</title>
	<link rel="apple-touch-icon" sizes="76x76" href="img/apple-icon.png">
	<link rel="icon" type="image/png" href="../../img/favicon.png">
	
	
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://cdn.rawgit.com/gaborcsardi/r-font/master/rlogo.css">
  <link rel="stylesheet" href="https://cdn.rawgit.com/wesbos/Font-Awesome-Docker-Icon/master/fontcustom/fontcustom.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css">

	
  <link href="../../css/bootstrap.min.css" rel="stylesheet" />
  <link href="../../css/material-kit.css" rel="stylesheet"/>
  
  

  
    
  <link rel="alternate" href="../../index.xml" type="application/rss+xml" title="ESPM 157">
  <link rel="feed" href="../../index.xml" type="application/rss+xml" title="ESPM 157">
  <link rel="canonical" href="../../assignment/extinction/">
</head>

  
<body class="profile-page">
  	<nav class="navbar navbar-transparent navbar-fixed-top navbar-color-on-scroll">
	    	<div class="container">
        	
        	<div class="navbar-header">
        		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example">
            		<span class="sr-only">Toggle navigation</span>
		            <span class="icon-bar"></span>
		            <span class="icon-bar"></span>
		            <span class="icon-bar"></span>
        		</button>
        		<a class="navbar-brand" href="../../">ESPM 157</a>
        	</div>

        	<div class="collapse navbar-collapse" id="navigation-example">
        		<ul class="nav navbar-nav navbar-right">
      
        

        <li class="nav-item">
          <a href="../../">
            <i class="sidebar-button-icon fa fa-lg fa-home"></i>
            <span>Home</span>
          </a>
        </li>
        
      
        

        <li class="nav-item">
          <a href="../../modules">
            <i class="material-icons">dashboard</i>
            <span>Modules</span>
          </a>
        </li>
        
      
        

        <li class="nav-item">
          <a href="../../tools">
            <i class="material-icons">build</i>
            <span>Tools</span>
          </a>
        </li>
        
      
        

        <li class="nav-item">
          <a href="../../syllabus">
            <i class="material-icons">date_range</i>
            <span>Syllabus</span>
          </a>
        </li>
        
      
        

        <li class="nav-item">
          <a href="../../policies">
            <i class="material-icons">gavel</i>
            <span>Policies</span>
          </a>
        </li>
        
      
        		</ul>
        	</div>
    	</div>
    </nav>
  <div class="wrapper">
    <div class="header header-filter" style="background-image: url('https://climate.nasa.gov/system/internal_resources/details/original/417_1263_banner-science-1600x500.jpg');">
    </div>
		<div class="main main-raised">
			<div class="container">
		  	<div class="section text-left">
		  	  <h2 class="title text-center">Extinctions Unit</h2>
	            <div id="extinctions-module" class="section level2">
<h2>Extinctions Module</h2>
<p><em>Are we experiencing the sixth great extinction?</em></p>
<p>What is the current pace of extinction? Is it accelerating? How does it compare to background extinction rates?</p>
</div>
<div id="background" class="section level2">
<h2>Background</h2>
<ul>
<li><a href="https://youtu.be/QsH6ytm89GI">Section Intro Video</a></li>
<li><a href="http://doi.org/10.1126/sciadv.1400253">Ceballos et al (2015)</a></li>
</ul>
</div>
<div id="computational-topics" class="section level2">
<h2>Computational Topics</h2>
<ul>
<li>Accessing data from a RESTful API</li>
<li>Error handling</li>
<li>JSON data format</li>
<li>Regular expressions</li>
<li>Working with missing values</li>
</ul>
</div>
<div id="additional-references" class="section level2">
<h2>Additional references:</h2>
<ul>
<li><a href="http://www.hhmi.org/biointeractive/biodiversity-age-humans" class="uri">http://www.hhmi.org/biointeractive/biodiversity-age-humans</a> (Video)</li>
<li><a href="http://doi.org/10.1038/nature09678">Barnosky et al. (2011)</a></li>
<li><a href="http://doi.org/10.1126/science.1246752">Pimm et al (2014)</a></li>
<li><a href="http://dx.doi.org/10.1098/rspb.2013.3254">Sandom et al (2014)</a></li>
</ul>
</div>
<div id="getting-started-based-on-live-code-session" class="section level1">
<h1>Getting started (based on live code session)</h1>
<div id="curl-and-rest" class="section level2">
<h2>CURL and REST</h2>
<p>Use the <code>httr</code> package to make a single API query against the following endpoint: <code>http://api.iucnredlist.org/index/species/Acaena-exigua.json</code></p>
<p>Examine the response and the content of the response. Can you tell if the call was successful? What was the return type object? Can you parse the return into an R object? Can you represent the return data as a data.frame?</p>
</div>
</div>
<div id="working-with-regular-expressions" class="section level1">
<h1>Working with Regular Expressions</h1>
<ul>
<li><a href="http://regexone.com/">Self-guided Tutorial</a></li>
<li><a href="http://www.cheatography.com/davechild/cheat-sheets/regular-expressions/">Cheetsheet</a></li>
<li><a href="https://cran.r-project.org/web/packages/stringr/vignettes/regular-expressions.html">stringr RegEx Vignette</a></li>
</ul>
<p>One of the entries in the response contains a field that may contain some information on when the species went extinct. Identify the appropriate column and extract this information using a <em>regular expression</em>, as discussed in the live code exercise.</p>
</div>
<div id="calculating-extinction-rates-putting-it-all-together" class="section level1">
<h1>Calculating Extinction Rates: Putting it all together</h1>
<p>First, to know what queries to make to the IUCN REST API, we need a list of extinct species names. This information can be downloaded from the IUCN website, but unfortunately this is not easily automated. Thus weâ€™ll download the data file using a copy already prepared for the course:</p>
<pre class="r"><code>extinct = read_csv(&quot;https://espm-157.github.io/extinction-module/extinct.csv&quot;)</code></pre>
<pre><code>Parsed with column specification:
cols(
  .default = col_character(),
  `Species ID` = col_integer(),
  `Red List criteria version` = col_double(),
  `Year assessed` = col_integer()
)</code></pre>
<pre><code>See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>extinct</code></pre>
<pre><code># A tibble: 834 x 23
   `Species ID`  Kingdom       Phylum         Class           Order
          &lt;int&gt;    &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;
 1        44072  PLANTAE TRACHEOPHYTA MAGNOLIOPSIDA         ROSALES
 2       195373  PLANTAE TRACHEOPHYTA MAGNOLIOPSIDA    EUPHORBIALES
 3        37854  PLANTAE TRACHEOPHYTA MAGNOLIOPSIDA    EUPHORBIALES
 4       199821  PLANTAE TRACHEOPHYTA MAGNOLIOPSIDA    EUPHORBIALES
 5           82 ANIMALIA   ARTHROPODA       INSECTA   EPHEMEROPTERA
 6          167 ANIMALIA     MOLLUSCA    GASTROPODA STYLOMMATOPHORA
 7          170 ANIMALIA     MOLLUSCA    GASTROPODA STYLOMMATOPHORA
 8          173 ANIMALIA     MOLLUSCA    GASTROPODA STYLOMMATOPHORA
 9          174 ANIMALIA     MOLLUSCA    GASTROPODA STYLOMMATOPHORA
10          179 ANIMALIA     MOLLUSCA    GASTROPODA STYLOMMATOPHORA
# ... with 824 more rows, and 18 more variables: Family &lt;chr&gt;,
#   Genus &lt;chr&gt;, Species &lt;chr&gt;, Authority &lt;chr&gt;, `Infraspecific
#   rank` &lt;chr&gt;, `Infraspecific name` &lt;chr&gt;, `Infraspecific
#   authority` &lt;chr&gt;, `Stock/subpopulation` &lt;chr&gt;, Synonyms &lt;chr&gt;, `Common
#   names (Eng)` &lt;chr&gt;, `Common names (Fre)` &lt;chr&gt;, `Common names
#   (Spa)` &lt;chr&gt;, `Red List status` &lt;chr&gt;, `Red List criteria` &lt;chr&gt;, `Red
#   List criteria version` &lt;dbl&gt;, `Year assessed` &lt;int&gt;, `Population
#   trend` &lt;chr&gt;, Petitioned &lt;chr&gt;</code></pre>
<p>Write a function to extract the rationale for the extinction for all extinct species in the data set (see above file)</p>
<p>Test your function on a subset of the data before attempting the full data set. Use our <code>dplyr</code> pipe syntax to iterate over your function.</p>
<p>Now create a function that can extract the date from the rationale, and include this function in your data analysis pipeline.</p>
<div id="histogram-of-extinction-dates" class="section level2">
<h2>Histogram of Extinction Dates</h2>
<p>We can get a sense for the tempo of extinctions by plotting extinctions since 1500 in 25-year interval bins.</p>
</div>
</div>
<div id="exercises" class="section level1">
<h1>Exercises</h1>
</div>
<div id="question-1-extinctions-by-group" class="section level1">
<h1>Question 1: Extinctions by group</h1>
<p>A. Compute the number of extinctions from 1500 - 1900 and from 1900 to present of each of the following taxonomic groups:</p>
<ul>
<li>Vertebrates</li>
<li>Mammals</li>
<li>Birds</li>
<li>Fish</li>
<li>Amphibians</li>
<li>Reptiles</li>
<li>Insects</li>
<li>Plants</li>
</ul>
<p>Compare your estimates to Table 1 of <a href="http://doi.org/10.1126/sciadv.1400253">Ceballos et al (2015)</a>.</p>
<div id="question-2-weighing-by-number-of-species" class="section level2">
<h2>Question 2: Weighing by number of species</h2>
<p>The number of species going extinct per century in a given taxonomic group will be influenced by how many species are present in the group to begin with. (For an obvious example, the number of vertebrate extinctions is always going to be higher than the number of mammal extinctions, since mammals are vertebrates). Overall, these numbers do not change greatly over a period of a few hundred years, so we were able to make the relative comparisons between the roughly pre-industrial and post-industrial periods above.</p>
<p>As discussed by Tony Barnosky in the introductory video (or in <a href="http://doi.org/10.1126/sciadv.1400253">Ceballos et al (2015)</a> paper), if we want to compare these extinction rates against the long-term palentological record, it is necessary to weigh the rates by the total number of species. That is, to compute the number of extinctions per million species per year (MSY; equivalently, the number extinctions per 10,000 species per 100 years).</p>
<ol style="list-style-type: upper-alpha">
<li>First, we will compute how many species are present in each of the taxonomic groups. To do so, we need a table that has not only extinct species, but all assessed species. We will once again query this information from the IUCN API.</li>
</ol>
<p>This is going to involve a lot of data â€“ more than the API can serve in a single chunk. Instead, the API breaks the returns up into groups of 10,000 species per page (see API docs: <a href="http://apiv3.iucnredlist.org/api/v3/docs#species" class="uri">http://apiv3.iucnredlist.org/api/v3/docs#species</a>). Luckily, the API also tells us the total number of species:</p>
<p><a href="http://apiv3.iucnredlist.org/api/v3/speciescount?token=9bb4facb6d23f48efbf424bb05c0c1ef1cf6f468393bc745d42179ac4aca5fee" class="uri">http://apiv3.iucnredlist.org/api/v3/speciescount?token=9bb4facb6d23f48efbf424bb05c0c1ef1cf6f468393bc745d42179ac4aca5fee</a></p>
<p>The code below queries the first page. How many pages will we need to get all the data? Modify the example below to collect all of the data into a single DataFrame. Note the use of <code>append</code> to add data to an existing data.frame with matching column labels.</p>
<ol start="2" style="list-style-type: upper-alpha">
<li>Based on the complete data, write queries that count the number of species in each group. Then use these numbers to compute MSY, the number extinctions per 10,000 species per 100 years, for each of the groups listed in Question 1. How do your estimates compare to the overall historical average of about 2 MSY?</li>
</ol>
</div>
<div id="question-3-improving-our-algorithm" class="section level2">
<h2>Question 3: Improving our algorithm</h2>
<p>In parsing the data with regular expressions, we encountered certain data that resulted in missing values. Identify and investigate the strings for which we were not able to extract a date value.</p>
<ul>
<li>Why did the date extraction fail?<br />
</li>
<li>Can you deduce an approximate date by examining the text?</li>
<li>Can you modify the regular expression to reduce the number of missing values?<br />
</li>
<li>How do these missing values impact our overall estimate of the extinction rate? (In which direction, and by approximately what amount?)</li>
</ul>
</div>
<div id="question-4-looking-forward-bonus" class="section level2">
<h2>Question 4: Looking forward (bonus)</h2>
<p>Plot the MSY rates in intervals of 50 years for each of the groups as a line plot (compare to Figure 1a of <a href="http://doi.org/10.1126/sciadv.1400253">Ceballos et al (2015)</a> paper). Compute the slope of these curves to forecast the extinction rate in 2100.</p>
</div>
</div>

	      </div>
      </div>
		</div>
    <footer class="footer">
  <div class="container">
	  <nav class="pull-left">
	    <ul>
	    
        

        <li>
          <a href="https://github.com/espm-157"><i class="button-icon fa fa-2x fa-github"></i> Team Repos</a>
        </li>
        
      
        

        <li>
          <a href="https://piazza.com/berkeley/fall2017/espm157/home"><i class="material-icons">forum</i> Forum</a>
        </li>
        
      
        

        <li>
          <a href="http://r4ds.had.co.nz/"><i class="material-icons">book</i> Textbook</a>
        </li>
        
      
        

        <li>
          <a href="http://travis.com/espm-157/"><i class="material-icons">check_circle</i> Travis-CI</a>
        </li>
        
      
        

        <li>
          <a href="https://www.datacamp.com/groups/espm-157-data-science-for-global-change-biology"><i class="material-icons">video_library</i> DataCamp Lessons</a>
        </li>
        
      
      </ul>
    </nav>
	  <div class="copyright pull-right">
	    <img src="../../img/cc-by.svg"/>
	  </div>
  </div>
</footer>
	</div>
</body>

   
  
  
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	
	
	
	<script src="../../js/material.min.js"></script>


	
	<script src="../../js/nouislider.min.js" type="text/javascript"></script>
	
	<script src="../../js/bootstrap-datepicker.js" type="text/javascript"></script>

	
	<script src="../../js/material-kit.js" type="text/javascript"></script>

   
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    
</html>
